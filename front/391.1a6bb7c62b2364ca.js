"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[391],{1257:(z,M,t)=>{t.d(M,{t:()=>P});var e=t(4438),n=t(431),i=t(1281),s=t(496),E=t(9640),h=t(3390),r=t(1747),p=t(5458);let P=(()=>{class v{constructor(D,u,y,d){this.store=D,this.modalService=u,this.actions$=y,this.rentService=d,this.estate=e.hFB.required(),this.lodgers=this.store.selectSignal(s.T)}downloadCustomizedRentReceipt(){this.rentService.downloadCustomizedRentReceipt(this.estate())}downloadRentReceipt(){this.rentService.downloadRentReceipt(this.estate())}senddRentReceipt(){this.rentService.sendRentReceiptByEmail(this.estate())}createLodger(){this.rentService.openCreateLodgerPopup(this.estate())}setLodger(D){this.store.dispatch((0,n.dG)({estate:{id:this.estate().id,lodger_id:D?.id??""}}))}deleteLodger(D){this.store.dispatch((0,i.rX)({lodgerId:D.id}))}static{this.\u0275fac=function(u){return new(u||v)(e.rXU(E.il),e.rXU(h.N_),e.rXU(r.En),e.rXU(p.t))}}static{this.\u0275dir=e.FsC({type:v,inputs:{estate:[1,"estate"]}})}}return v})()},3457:(z,M,t)=>{t.d(M,{N:()=>v});var e=t(4438),n=t(7462),i=t(7498),s=t(431),E=t(889),h=t(1176),r=t(9640),p=t(3390),P=t(1747);let v=(()=>{class U{constructor(u,y,d){this.store=u,this.modalService=y,this.actions$=d,this.estate=e.hFB.required(),this.owners=this.store.selectSignal(h.P)}openCreateOwnerPopup(){this.modalService.create({nzTitle:"Ajouter un nouveau propri\xe9taire",nzContent:n.X,nzFooter:null})}openEditOwnerPopup(u){this.modalService.create({nzTitle:"\xe9ditier un propri\xe9taire",nzContent:i.r,nzData:{owner:u},nzFooter:null})}createOwner(u){this.openCreateOwnerPopup()}setOwner(u,y){this.store.dispatch((0,s.dG)({estate:{...u,owner_id:y.id}}))}deleteOwner(u){this.store.dispatch((0,E.HD)({ownerId:u.id}))}editOwner(u){this.openEditOwnerPopup(u)}static{this.\u0275fac=function(y){return new(y||U)(e.rXU(r.il),e.rXU(p.N_),e.rXU(P.En))}}static{this.\u0275dir=e.FsC({type:U,inputs:{estate:[1,"estate"]}})}}return U})()},370:(z,M,t)=>{t.d(M,{y:()=>A});var e=t(431),n=t(9640);const h=c=>{const f=new Date;let l=!1;return c.forEach(O=>{f.getFullYear()===O.year&&f.getMonth()===O.month&&(l=!0)}),l},r=c=>{const f=new Date;return!!c.find(O=>O.year===f.getFullYear()&&O.month===f.getMonth())?.sent},p=(0,n.UX)("estates"),P=(0,n.UX)("owners"),v=(0,n.UX)("lodgers"),U=(0,n.UX)("rents"),D=(0,n.Mz)(p,P,v,U,(c,f,l,O)=>((c,f,l,O)=>c.map(w=>((c,f,l,O)=>({...c,address:c.street+" "+c.city+" "+c.zip,plot_address:c.plot?"LOT "+c.plot+" / "+c.street+" "+c.city+" "+c.zip:c.street+" "+c.city+" "+c.zip,owner:f.find(w=>w.id+""==c.owner_id+""),lodger:l.find(w=>w.id+""==c.lodger_id+""),rents:O,actualMonthPaid:h(O),rentReceiptSentByEmail:r(O)}))(w,f,l,O.find(S=>S.estateId===w.id)?.rents??[])))(c.estates,f.owners,l.lodgers,O.monthlyRents_Dto));var u=t(496),y=t(1176),d=t(4341),L=t(513),g=t(1997),a=t(4438);let $=(()=>{class c{constructor(l,O){this.formBuilder=l,this.store=O,this.owners=this.store.selectSignal(y.P)}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({street:new d.MJ("",[d.k0.required]),city:new d.MJ("",[d.k0.required]),zip:new d.MJ("",[d.k0.required]),plot:new d.MJ(""),rent:new d.MJ(0),charges:new d.MJ(0),owner:new d.MJ(this.owners().length?this.owners()[0].id:null),lodger:new d.MJ("")})}create(){if(this.formGroup.invalid)return;const l=(c=>{let f=c.get("owner")?.value;return"string"!=typeof f&&"number"!=typeof f&&f&&(f=c.get("owner")?.value?.id),{street:c.get("street").value,city:c.get("city").value,zip:c.get("zip").value,plot:c.get("plot")?.value,rent:c.get("rent")?.value,charges:c.get("charges")?.value,owner_id:f,lodger_id:c.get("lodger")?.value}})(this.formGroup);this.store.dispatch((0,e.l6)({estate:l}))}static{this.\u0275fac=function(O){return new(O||c)(a.rXU(d.ok),a.rXU(n.il))}}static{this.\u0275dir=a.FsC({type:c})}}return c})();var I=t(6389),R=t(5930);function F(c,f){if(1&c&&a.nrm(0,"nz-option",8),2&c){const l=f.$implicit;a.Y8G("nzValue",l.id)("nzLabel",l.name)}}let o=(()=>{class c extends ${static{this.\u0275fac=(()=>{let l;return function(w){return(l||(l=a.xGo(c)))(w||c)}})()}static{this.\u0275cmp=a.VBU({type:c,selectors:[["create-estate-popup"]],standalone:!0,features:[a.Vt3,a.aNF],decls:21,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["type","text","formControlName","plot",1,"form-control"],["for","owner"],["formControlName","owner","nzPlaceHolder","Propri\xe9taire",1,"select"],[3,"nzValue","nzLabel"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(O,w){1&O&&(a.j41(0,"form",0)(1,"label",1),a.EFF(2,"Adresse"),a.k0s(),a.nrm(3,"input",2),a.j41(4,"label",1),a.EFF(5,"Ville"),a.k0s(),a.nrm(6,"input",3),a.j41(7,"label",1),a.EFF(8,"Code Postal"),a.k0s(),a.nrm(9,"input",4),a.j41(10,"label",1),a.EFF(11,"Lot"),a.k0s(),a.nrm(12,"input",5),a.j41(13,"label",6),a.EFF(14,"Propri\xe9taire"),a.k0s(),a.j41(15,"nz-select",7),a.Z7z(16,F,1,2,"nz-option",8,a.fX1),a.k0s()(),a.j41(18,"div",9)(19,"button",10),a.bIt("click",function(){return w.create()}),a.EFF(20,"cr\xe9er"),a.k0s()()),2&O&&(a.Y8G("formGroup",w.formGroup),a.R7$(16),a.Dyx(w.owners()))},dependencies:[d.X1,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,g.DH,g.ld,g.WI,L.Zw,L.aO,I.c,R.p],styles:[".form-group-popup[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;justify-content:flex-start;align-items:flex-start}"]})}}return c})();var C=t(3390),m=t(1747),T=t(8113);let A=(()=>{class c{constructor(l,O,w,S){this.store=l,this.modalService=O,this.actions$=w,this.rentHttpService=S,this.owners=this.store.selectSignal(y.P),this.lodgers=this.store.selectSignal(u.T),this.estates=this.store.selectSignal(D)}ngOnInit(){this.store.dispatch((0,e.kW)())}synchronizeGoogleSheet(){this.rentHttpService.synchronizeGoogleSheet().subscribe()}openCreateEstatePopup(){return this.modalService.create({nzTitle:"Cr\xe9er un nouveau bien",nzContent:o,nzFooter:null})}startEdit(l,O){this.editId=l,setTimeout(()=>{requestAnimationFrame(()=>{O.focus()})},0)}stopEdit(){this.editId=null}edit(l,O,w){const S={id:l.id};S[O]=w.value,this.store.dispatch({type:"[Estates] Edit Estate",estate:S})}deleteEstate(l){this.store.dispatch((0,e.su)({estateId:l.id}))}static{this.\u0275fac=function(O){return new(O||c)(a.rXU(n.il),a.rXU(C.N_),a.rXU(m.En),a.rXU(T.M))}}static{this.\u0275dir=a.FsC({type:c})}}return c})()},7462:(z,M,t)=>{t.d(M,{X:()=>D});var e=t(4341),n=t(889),i=t(2062),s=t(4438),E=t(9640);let h=(()=>{class u{constructor(d,L){this.formBuilder=d,this.store=L}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({name:new e.MJ("",[e.k0.required]),street:new e.MJ("",[e.k0.required]),city:new e.MJ("",[e.k0.required]),zip:new e.MJ("",[e.k0.required]),signature:new e.MJ("")})}create(){if(this.formGroup.invalid)return;const d=(0,i.g)(this.formGroup);this.store.dispatch((0,n.lv)({owner:d}))}static{this.\u0275fac=function(L){return new(L||u)(s.rXU(e.ok),s.rXU(E.il))}}static{this.\u0275dir=s.FsC({type:u})}}return u})();var r=t(1997),p=t(513),P=t(8468),v=t(6389),U=t(5930);let D=(()=>{class u extends h{static{this.\u0275fac=(()=>{let d;return function(g){return(d||(d=s.xGo(u)))(g||u)}})()}static{this.\u0275cmp=s.VBU({type:u,selectors:[["app-create-owner-popup"]],standalone:!0,features:[s.Vt3,s.aNF],decls:19,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["formControlName","signature"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(L,g){1&L&&(s.j41(0,"form",0)(1,"label",1),s.EFF(2,"Nom et pr\xe9nom"),s.k0s(),s.nrm(3,"input",2),s.j41(4,"label",1),s.EFF(5,"Adresse"),s.k0s(),s.nrm(6,"input",3),s.j41(7,"label",1),s.EFF(8,"Ville"),s.k0s(),s.nrm(9,"input",4),s.j41(10,"label",1),s.EFF(11,"Code Postal"),s.k0s(),s.nrm(12,"input",5),s.j41(13,"label",1),s.EFF(14,"Signature"),s.k0s(),s.nrm(15,"signature-pad",6),s.k0s(),s.j41(16,"div",7)(17,"button",8),s.bIt("click",function(){return g.create()}),s.EFF(18,"cr\xe9er"),s.k0s()()),2&L&&s.Y8G("formGroup",g.formGroup)},dependencies:[e.X1,e.qT,e.me,e.BC,e.cb,e.j4,e.JD,r.DH,p.Zw,p.aO,v.c,U.p,P.u]})}}return u})()},7498:(z,M,t)=>{t.d(M,{r:()=>a});var e=t(4341),n=t(513),i=t(1997),s=t(3390),E=t(889),h=t(2062),r=t(4438),p=t(9640);let P=(()=>{class ${constructor(R,F,o){this.data=R,this.formBuilder=F,this.store=o}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({name:new e.MJ(this.data?.owner?.name??"",[e.k0.required]),street:new e.MJ(this.data?.owner?.street??""),city:new e.MJ(this.data?.owner?.city??""),zip:new e.MJ(this.data?.owner?.zip??""),signature:new e.MJ(this.data?.owner?.signature??"")})}edit(){if(this.formGroup.invalid)return;const R=(0,h.o)(this.formGroup,this.data.owner.id);this.store.dispatch((0,E.He)({owner:R}))}static{this.\u0275fac=function(F){return new(F||$)(r.rXU(s.or),r.rXU(e.ok),r.rXU(p.il))}}static{this.\u0275dir=r.FsC({type:$})}}return $})();var v=t(8468),U=t(1747),D=t(1413),u=t(6977),y=t(6697),d=t(8141),L=t(6389),g=t(5930);let a=(()=>{class $ extends P{constructor(R,F,o,C,m){super(R,F,o),this.data=R,this.formBuilder=F,this.store=o,this.modalRef=C,this.actions$=m,this.destroyed$=new D.B}ngOnInit(){super.ngOnInit(),this.actions$.pipe((0,U.gp)(E.eX),(0,u.Q)(this.destroyed$),(0,y.s)(1),(0,d.M)(()=>this.modalRef.close())).subscribe()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static{this.\u0275fac=function(F){return new(F||$)(r.rXU(s.or),r.rXU(e.ok),r.rXU(p.il),r.rXU(s.J9),r.rXU(U.En))}}static{this.\u0275cmp=r.VBU({type:$,selectors:[["edit-owner-popup"]],standalone:!0,features:[r.Vt3,r.aNF],decls:19,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["formControlName","signature"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(F,o){1&F&&(r.j41(0,"form",0)(1,"label",1),r.EFF(2,"Nom et pr\xe9nom"),r.k0s(),r.nrm(3,"input",2),r.j41(4,"label",1),r.EFF(5,"Adresse"),r.k0s(),r.nrm(6,"input",3),r.j41(7,"label",1),r.EFF(8,"Ville"),r.k0s(),r.nrm(9,"input",4),r.j41(10,"label",1),r.EFF(11,"Code Postal"),r.k0s(),r.nrm(12,"input",5),r.j41(13,"label",1),r.EFF(14,"Signature"),r.k0s(),r.nrm(15,"signature-pad",6),r.k0s(),r.j41(16,"div",7)(17,"button",8),r.bIt("click",function(){return o.edit()}),r.EFF(18,"\xe9diter"),r.k0s()()),2&F&&r.Y8G("formGroup",o.formGroup)},dependencies:[e.X1,e.qT,e.me,e.BC,e.cb,e.j4,e.JD,i.DH,n.Zw,n.aO,L.c,g.p,v.u]})}}return $})()},2552:(z,M,t)=>{t.d(M,{H:()=>F});var e=t(177),n=t(1747),i=t(9640),s=t(1281),E=t(3993),h=t(6354),r=t(5558),p=t(7673),P=t(9437),v=t(8141),U=t(889),D=t(496),u=t(431),y=t(4438),d=t(5312),L=t(1626);let g=(()=>{class o{constructor(m){this.http=m,this.API_URL=d.c.apiURL}create(m){return this.http.post(`${this.API_URL}/lodgers`,m)}read(){return this.http.get(`${this.API_URL}/lodgers`)}update(m){return this.http.patch(`${this.API_URL}/lodgers`,m)}delete(m){return this.http.delete(`${this.API_URL}/lodgers`,{body:{id:m}}).pipe((0,h.T)(()=>m))}static{this.\u0275fac=function(T){return new(T||o)(y.KVO(L.Qq))}}static{this.\u0275prov=y.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var a=t(7094);let $=(()=>{class o{constructor(m,T,A,c){this.actions$=m,this.lodgerService=T,this.store=A,this.message=c,this.loadOwners$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.z8),(0,E.E)(this.store.select(D.T)),(0,h.T)(([f,l])=>l),(0,r.n)(f=>f&&f.length>0?(0,p.of)((0,s.Yq)({lodgers:f})):this.lodgerService.read().pipe((0,h.T)(l=>(0,s.Yq)({lodgers:l})),(0,P.W)(l=>(0,p.of)((0,U.fJ)(l))))))),this.createLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.EU),(0,r.n)(({lodger:f,estateId:l})=>this.lodgerService.create(f).pipe((0,h.T)(O=>(l&&this.store.dispatch((0,u.dG)({estate:{id:l,lodger_id:O.id}})),(0,s.B8)({lodger:O}))),(0,P.W)(O=>(0,p.of)((0,s.qU)(O))))))),this.createLodgerSuccess$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.B8),(0,v.M)(()=>this.message.success("locataire ajout\xe9 avec succ\xe8s!"))),{dispatch:!1}),this.createLodgerFailure$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.qU),(0,v.M)(f=>this.message.error(f.error.message))),{dispatch:!1}),this.updateLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.Z1),(0,r.n)(f=>this.lodgerService.update(f.lodger).pipe((0,h.T)(l=>(0,s.YG)({lodger:l})),(0,P.W)(l=>(0,p.of)((0,s.d9)(l))))))),this.deleteLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(s.rX),(0,r.n)(f=>this.lodgerService.delete(f.lodgerId).pipe((0,h.T)(l=>(0,s.CI)({lodgerId:l})),(0,P.W)(()=>(0,p.of)((0,s.CI)(f.ownerId)))))))}static{this.\u0275fac=function(T){return new(T||o)(y.KVO(n.En),y.KVO(g),y.KVO(i.il),y.KVO(a.xh))}}static{this.\u0275prov=y.jDH({token:o,factory:o.\u0275fac})}}return o})();const R=(0,i.vy)({lodgers:[]},(0,i.on)(s.Yq,(o,{lodgers:C})=>({...o,lodgers:C})),(0,i.on)(s.B8,(o,{lodger:C})=>({...o,lodgers:o.lodgers.concat(C)})),(0,i.on)(s.YG,(o,{lodger:C})=>({...o,lodgers:o.lodgers.map(m=>m.id===C.id?{...m,...C}:m)})),(0,i.on)(s.CI,(o,{lodgerId:C})=>({...o,lodgers:o.lodgers.filter(m=>m.id!==C)})));let F=(()=>{class o{constructor(m,T){this.store=m,this.actions$=T,this.store.dispatch((0,s.z8)())}static{this.\u0275fac=function(T){return new(T||o)(y.KVO(i.il),y.KVO(n.En))}}static{this.\u0275mod=y.$C({type:o})}static{this.\u0275inj=y.G2t({imports:[e.MD,i.md.forFeature("lodgers",R),n.Vm.forFeature($)]})}}return o})()},8221:(z,M,t)=>{t.d(M,{j:()=>F});var e=t(177),n=t(1747),i=t(9640),s=t(6697),E=t(8141),h=t(889),r=t(3993),p=t(6354),P=t(5558),v=t(7673),U=t(9437),D=t(1176),u=t(4438),y=t(5312),d=t(1626);let L=(()=>{class o{constructor(m){this.http=m,this.API_URL=y.c.apiURL}get(){return this.http.get(`${this.API_URL}/owners`)}create(m){return this.http.post(`${this.API_URL}/owners`,m)}edit(m){return this.http.patch(`${this.API_URL}/owners`,m).pipe((0,p.T)(T=>m))}delete(m){return this.http.delete(`${this.API_URL}/owners`,{body:{id:m}}).pipe((0,p.T)(T=>m))}static{this.\u0275fac=function(T){return new(T||o)(u.KVO(d.Qq))}}static{this.\u0275prov=u.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var g=t(7094);let a=(()=>{class o{constructor(m,T,A,c){this.actions$=m,this.ownerService=T,this.store=A,this.message=c,this.loadOwners$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(h.Ju),(0,r.E)(this.store.select(D.P)),(0,p.T)(([f,l])=>l),(0,P.n)(f=>f&&f.length>0?(0,v.of)({type:"[Owners] Load Owners Success",owners:f}):this.ownerService.get().pipe((0,p.T)(l=>({type:"[Owners] Load Owners Success",owners:l})),(0,U.W)(()=>(0,v.of)({type:"[Owners] Load Owners Failure"})))))),this.addOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Add Owner"),(0,P.n)(({owner:f})=>this.ownerService.create(f).pipe((0,p.T)(l=>({type:"[Owners] Add Owner Success",owner:l})),(0,U.W)(()=>(0,v.of)({type:"[Owners] Load Owners Failure"})))))),this.addOwnerSuccess$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(h._P),(0,E.M)(()=>this.message.success("propri\xe9taire ajout\xe9 avec succ\xe8s!"))),{dispatch:!1}),this.addOwnerFailure$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(h.LM),(0,E.M)(f=>this.message.error(f.error.message))),{dispatch:!1}),this.updateOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Update Owner"),(0,P.n)(({owner:f})=>this.ownerService.edit(f).pipe((0,p.T)(l=>(0,h.eX)({owner:l})),(0,U.W)(()=>(0,v.of)({type:"[Owners] Update Owner Failure"})))))),this.deleteOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Delete Owner"),(0,P.n)(f=>this.ownerService.delete(f.ownerId).pipe((0,p.T)(l=>({type:"[Owners] Delete Owner Success",ownerId:l})),(0,U.W)(()=>(0,v.of)({type:"[Owners] Delete Owner Failure"}))))))}static{this.\u0275fac=function(T){return new(T||o)(u.KVO(n.En),u.KVO(L),u.KVO(i.il),u.KVO(g.xh))}}static{this.\u0275prov=u.jDH({token:o,factory:o.\u0275fac})}}return o})();const I=(0,i.vy)({owners:[]},(0,i.on)(h.Ju,(o,C)=>({...o})),(0,i.on)(h.kN,(o,C)=>({...o,owners:C.owners})),(0,i.on)(h.fJ,(o,C)=>({...o})),(0,i.on)(h.lv,(o,C)=>({...o})),(0,i.on)(h._P,(o,C)=>({...o,owners:o.owners.concat(C.owner)})),(0,i.on)(h.LM,(o,C)=>({...o})),(0,i.on)(h.HD,(o,C)=>({...o})),(0,i.on)(h.eX,(o,{owner:C})=>({...o,owners:o.owners.map(m=>m.id===C.id?{...m,...C}:m)})),(0,i.on)(h.ye,(o,{ownerId:C})=>({...o,owners:o.owners.filter(m=>m.id!==C)})),(0,i.on)(h.XB,(o,C)=>({...o})));var R=t(5213);let F=(()=>{class o{constructor(m){this.store=m,this.loadOwners()}loadOwners(){this.store.select(R.d).pipe((0,s.s)(1),(0,E.M)(m=>this.store.dispatch((0,h.Ju)()))).subscribe()}static{this.\u0275fac=function(T){return new(T||o)(u.KVO(i.il))}}static{this.\u0275mod=u.$C({type:o})}static{this.\u0275inj=u.G2t({imports:[e.MD,i.md.forFeature("owners",I),n.Vm.forFeature(a)]})}}return o})()},9183:(z,M,t)=>{t.d(M,{X:()=>P});var e=t(177),n=t(1747),i=t(9640),s=t(2440),E=t(1069);const r=(0,i.vy)({monthlyRents_Dto:[]},(0,i.on)(s.Dh,(v,U)=>({monthlyRents_Dto:U.monthlyRents})));var p=t(4438);let P=(()=>{class v{constructor(D,u){this.store=D,this.actions$=u,this.store.dispatch((0,s.Y6)())}static{this.\u0275fac=function(u){return new(u||v)(p.KVO(i.il),p.KVO(n.En))}}static{this.\u0275mod=p.$C({type:v})}static{this.\u0275inj=p.G2t({imports:[e.MD,i.md.forFeature("rents",r),n.Vm.forFeature(E.H)]})}}return v})()},8113:(z,M,t)=>{t.d(M,{M:()=>s});var e=t(5312),n=t(4438),i=t(1626);let s=(()=>{class E{constructor(r){this.http=r,this.API_URL=e.c.apiURL}loadMonthlyRents(){return this.http.get(`${this.API_URL}/rents`)}downloadRentReceipt(r,p,P){let v=`estate=${r}`;return p&&(v+=`&startDate=${p}`),P&&(v+=`&endDate=${P}`),this.http.get(`${this.API_URL}/rents/pdf?${v}`,{responseType:"blob"})}sendRentReceipt(r,p,P){let v=`estate=${r}`;return p&&(v+=`&startDate=${p}`),P&&(v+=`&endDate=${P}`),this.http.get(`${this.API_URL}/rents/email?${v}`)}synchronizeGoogleSheet(){return this.http.get(`${this.API_URL}/rents/sheets`)}static{this.\u0275fac=function(p){return new(p||E)(n.KVO(i.Qq))}}static{this.\u0275prov=n.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}}return E})()},8543:(z,M,t)=>{t.d(M,{u:()=>y});var e=t(1747),n=t(5558),i=t(6354),s=t(9437),E=t(7673),h=t(8141),r=t(431),p=t(4438),P=t(5312),v=t(1626);let U=(()=>{class d{constructor(g){this.http=g,this.API_URL=P.c.apiURL}getEstates(){return this.http.get(`${this.API_URL}/estates`)}create(g){return this.http.post(`${this.API_URL}/estates`,g)}editEstate(g){return this.http.patch(`${this.API_URL}/estate`,g)}deleteEstate(g){return this.http.delete(`${this.API_URL}/estates`,{body:{id:g}})}static{this.\u0275fac=function(a){return new(a||d)(p.KVO(v.Qq))}}static{this.\u0275prov=p.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})();var D=t(8113),u=t(7094);let y=(()=>{class d{constructor(g,a,$,I){this.actions$=g,this.estatesService=a,this.rentsService=$,this.message=I,this.loadEstates$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Load Estates"),(0,n.n)(()=>this.estatesService.getEstates().pipe((0,i.T)(R=>({type:"[Estates] Load Estates Success",estates:R})),(0,s.W)(()=>(0,E.of)({type:"[Estates] Load Estates Failure"})))))),this.createEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Create Estate"),(0,n.n)(({estate:R})=>this.estatesService.create(R).pipe((0,i.T)(F=>({type:"[Estates] Create Estate Success",estate:F})),(0,s.W)(({error:F})=>(0,E.of)({type:"[Estates] Create Estate Failure",error:F})))))),this.createEstateSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.Cs),(0,h.M)(()=>{this.message.success("Bien ajout\xe9 avec succ\xe8s!")})),{dispatch:!1}),this.editEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Edit Estate"),(0,n.n)(({estate:R})=>this.estatesService.editEstate(R).pipe((0,i.T)(()=>({type:"[Estates] Edit Estate Success",estate:R})),(0,s.W)(()=>(0,E.of)({type:"[Estates] Edit Estate Failure"})))))),this.deleteEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.su),(0,n.n)(({estateId:R})=>this.estatesService.deleteEstate(R).pipe((0,i.T)(()=>(0,r.Ng)({estateId:R})),(0,s.W)(()=>(0,E.of)({type:"[Estates] Delete Estate Failure"}))))))}static{this.\u0275fac=function(a){return new(a||d)(p.KVO(e.En),p.KVO(U),p.KVO(D.M),p.KVO(u.xh))}}static{this.\u0275prov=p.jDH({token:d,factory:d.\u0275fac})}}return d})()},7211:(z,M,t)=>{t.d(M,{i:()=>s});var e=t(9640),n=t(431);const s=(0,e.vy)({estates:[]},(0,e.on)(n.Lj,(E,h)=>({...E,estates:h.estates})),(0,e.on)(n.Cs,(E,h)=>({...E,estates:[...E.estates,h.estate]})),(0,e.on)(n.wP,(E,h)=>({...E,estates:E.estates.map(r=>r.id===h.estate.id?{...r,...h.estate}:r)})),(0,e.on)(n.Ng,(E,{estateId:h})=>({...E,estates:E.estates.filter(r=>r.id!==h)})))},496:(z,M,t)=>{t.d(M,{T:()=>i});var e=t(9640);const n=(0,e.UX)("lodgers"),i=(0,e.Mz)(n,s=>s.lodgers)},1176:(z,M,t)=>{t.d(M,{P:()=>i});var e=t(9640);const n=(0,e.UX)("owners"),i=(0,e.Mz)(n,s=>s.owners)},1069:(z,M,t)=>{t.d(M,{H:()=>U});var e=t(1747),n=t(5558),i=t(8141),s=t(6354),E=t(9437),h=t(7673),r=t(2440),p=t(4438),P=t(8113),v=t(7094);let U=(()=>{class D{constructor(y,d,L){this.actions$=y,this.rentsService=d,this.message=L,this.downloadRentReceipt$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.KP),(0,n.n)(({estateId:g,startDate:a,endDate:$})=>this.rentsService.downloadRentReceipt(g,a,$).pipe((0,i.M)(I=>{const R=window.URL.createObjectURL(I),F=document.createElement("a");F.href=R,F.download="quittance.pdf",F.click(),window.URL.revokeObjectURL(R)}),(0,s.T)(I=>(0,r.n9)()),(0,E.W)(I=>(0,h.of)((0,r.kZ)(I))))))),this.downloadRentReceiptSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.n9),(0,s.T)(g=>(0,r.Y6)()))),this.sendRentReceipt$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.eT),(0,n.n)(({estate:g,startDate:a,endDate:$})=>this.rentsService.sendRentReceipt(g.id,a,$).pipe((0,s.T)(I=>(0,r.tT)({estate:I})),(0,E.W)(I=>(0,h.of)((0,r.eV)(I))))))),this.sendRentReceiptSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.tT),(0,i.M)(g=>this.message.success("Votre quittance a bien \xe9t\xe9 envoy\xe9e.")),(0,s.T)(g=>(0,r.Y6)()))),this.sendRentReceiptFaillure$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.eV),(0,i.M)(g=>this.message.error("Failed to send rent receipt"))),{dispatch:!1}),this.loadMonthlyRents$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(r.Y6),(0,n.n)(()=>this.rentsService.loadMonthlyRents().pipe((0,s.T)(g=>(0,r.Dh)({monthlyRents:g})),(0,E.W)(g=>(0,h.of)((0,r.Eh)(g)))))))}static{this.\u0275fac=function(d){return new(d||D)(p.KVO(e.En),p.KVO(P.M),p.KVO(v.xh))}}static{this.\u0275prov=p.jDH({token:D,factory:D.\u0275fac})}}return D})()},2062:(z,M,t)=>{t.d(M,{g:()=>e,o:()=>n});const e=i=>({name:i.get("name").value,street:i.get("street").value,city:i.get("city").value,zip:i.get("zip").value,signature:i.get("signature")?.value}),n=(i,s)=>({name:i.get("name").value,street:i.get("street").value,city:i.get("city").value,zip:i.get("zip").value,signature:i.get("signature")?.value,id:s})}}]);