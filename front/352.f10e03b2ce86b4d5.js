"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[352],{352:(Qe,M,p)=>{p.r(M),p.d(M,{ProspectionsModule:()=>Ke});var S=p(177),a=p(1747),i=p(9640),g=p(513),ie=p(2047),k=p(3390),C=p(4041),F=p(8141),se=p(5558),m=p(6354),h=p(1397),f=p(9437),v=p(7673);const G=(0,i.VP)("[Prospections] Load Prospections"),R=(0,i.VP)("[Prospections] Load Prospections Success",(0,i.xk)()),N=((0,i.VP)("[Prospections] Load Prospections Failure",(0,i.xk)()),(0,i.VP)("[Prospection] Create Prospection",(0,i.xk)())),U=(0,i.VP)("[Prospection] Create Prospection Success",(0,i.xk)()),L=((0,i.VP)("[Prospection] Create Prospection Failure",(0,i.xk)()),(0,i.VP)("[Prospection] Remove Prospection",(0,i.xk)())),X=(0,i.VP)("[Prospection] Remove Prospection Success",(0,i.xk)()),le=(0,i.VP)("[Prospection] Remove Prospection Failure",(0,i.xk)()),P=(0,i.VP)("[Prospection] Update Prospection",(0,i.xk)()),z=(0,i.VP)("[Prospection] Update Prospection Success",(0,i.xk)()),I=(0,i.VP)("[Prospection] Update Prospection Failure",(0,i.xk)());var e=p(4438),T=p(5312),$=p(1626);let ce=(()=>{class o{constructor(t){this.http=t,this.apiUrl=`${T.c.apiURL}/prospections`}getAll(){return this.http.get(`${this.apiUrl}`)}getById(t){return this.http.get(`${this.apiUrl}/${t}`)}create(t){return this.http.post(`${this.apiUrl}`,t)}update(t,n){return this.http.patch(`${this.apiUrl}/${t}`,n)}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO($.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),pe=(()=>{class o{constructor(t,n){this.actions$=t,this.prospectionsService=n,this.loadProspections$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(G),(0,F.M)(r=>console.log("loadProspections",r)),(0,se.n)(()=>this.prospectionsService.getAll()),(0,F.M)(r=>console.log("prospections res",r)),(0,m.T)(r=>R({prospections:r})))),this.createProspection$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(N),(0,h.Z)(r=>this.prospectionsService.create(r.prospection).pipe((0,F.M)(console.log),(0,m.T)(s=>U({prospection:s})))))),this.removeProspection$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(L),(0,h.Z)(r=>this.prospectionsService.delete(r.id).pipe((0,m.T)(()=>X({id:r.id})),(0,f.W)(s=>(0,v.of)(le({error:s}))))))),this.updateProspection$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(P),(0,h.Z)(r=>this.prospectionsService.update(r.id,r.changes).pipe((0,m.T)(()=>z({id:r.id,changes:r.changes})),(0,f.W)(s=>(0,v.of)(I({error:s})))))))}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(a.En),e.KVO(ce))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac})}}return o})();const de=(0,i.vy)({prospections:[]},(0,i.on)(R,(o,{prospections:l})=>(console.log("prospections",l),{...o,prospections:l})),(0,i.on)(U,(o,{prospection:l})=>({...o,prospections:[...o.prospections,l]})),(0,i.on)(X,(o,{id:l})=>({...o,prospections:o.prospections.filter(t=>t.id!==l)})),(0,i.on)(z,(o,{id:l,changes:t})=>({...o,prospections:o.prospections.map(n=>n.id===l?{...n,...t}:n)})));var B=p(1188);const ue=(0,i.UX)("sellers"),A=(0,i.Mz)(ue,o=>o.sellers.map(l=>({...l,displayName:me(l)}))),me=o=>{let l=o.name;return(!l||""===l)&&(l=o.agency),(!l||""===l)&&(l="inconnu"),l},Y=[{key:"Unresponsive",label:"Sans r\xe9ponse",shortLabel:"attente",color:"var(--rentx-prospection-color-unresponsive)",colorLight:"var(--rentx-prospection-color-unresponsive-active)",icon:"question-circle",iconTheme:"fill"},{key:"Contacted",label:"Contact\xe9",shortLabel:"contact",color:"var(--rentx-prospection-color-contacted)",colorLight:"var(--rentx-prospection-color-contacted-active)",icon:"message",iconTheme:"fill"},{key:"Scheduled",label:"Visite planifi\xe9e",shortLabel:"visite",color:"var(--rentx-prospection-color-scheduled)",colorLight:"var(--rentx-prospection-color-scheduled-active)",icon:"calendar",iconTheme:"fill"},{key:"Visited",label:"Visite effectu\xe9e",shortLabel:"visite",color:"var(--rentx-prospection-color-visited)",colorLight:"var(--rentx-prospection-color-visited-active)",icon:"eye",iconTheme:"fill"},{key:"Abandoned",label:"Bien abandonn\xe9",shortLabel:"abandonn\xe9",color:"var(--rentx-prospection-color-abandoned)",colorLight:"var(--rentx-prospection-color-abandoned-active)",icon:"stop",iconTheme:"fill"},{key:"Pending",label:"Offre envoy\xe9e",shortLabel:"envoy\xe9",color:"var(--rentx-prospection-color-pending)",colorLight:"var(--rentx-prospection-color-pending-active)",icon:"hourglass",iconTheme:"fill"},{key:"Declined",label:"Offre refus\xe9e",shortLabel:"refus\xe9e",color:"var(--rentx-prospection-color-declined)",colorLight:"var(--rentx-prospection-color-declined-active)",icon:"close-circle",iconTheme:"fill"},{key:"Countered",label:"Contre proposition",shortLabel:"contr\xe9",color:"var(--rentx-prospection-color-countered)",colorLight:"var(--rentx-prospection-color-countered-active)",icon:"swap-left",iconTheme:"outline"},{key:"Accepted",label:"Offre accept\xe9e",shortLabel:"accept\xe9",color:"var(--rentx-prospection-color-accepted)",colorLight:"var(--rentx-prospection-color-accepted-active)",icon:"check-circle",iconTheme:"fill"},{key:"Validated",label:"Date de compromis de vente valid\xe9e",shortLabel:"compromis",color:"var(--rentx-prospection-color-validated)",colorLight:"var(--rentx-prospection-color-validated-active)",icon:"calendar",iconTheme:"fill"},{key:"Signed",label:"Compromis de vente sign\xe9",shortLabel:"compromis",color:"var(--rentx-prospection-color-signed)",colorLight:"var(--rentx-prospection-color-signed-active)",icon:"file-done",iconTheme:"outline"},{key:"Completed",label:"Acquisition termin\xe9e",shortLabel:"acquis",color:"var(--rentx-prospection-color-completed)",colorLight:"var(--rentx-prospection-color-completed-active)",icon:"trophy",iconTheme:"fill"},{key:"UnderContract",label:"Bien sous compromis de vente",shortLabel:"perdu",color:"var(--rentx-prospection-color-undercontract",colorLight:"var(--rentx-prospection-color-undercontract-active)",icon:"form",iconTheme:"outline"},{key:"Sold",label:"Bien vendu",shortLabel:"perdu",color:"var(--rentx-prospection-color-sold)",colorLight:"var(--rentx-prospection-color-sold-active)",icon:"lock",iconTheme:"fill"}],H=(0,i.UX)("offers"),he=((0,i.Mz)(H,o=>o.offers.map(l=>({...l}))),(0,i.UX)("prospections")),fe=((0,i.UX)("sellers"),(0,i.Mz)(he,A,H,(o,l,t)=>ve(o.prospections,l,t.offers))),ve=(o,l,t)=>o.map(n=>{const r=l?.find(s=>s.id===n.seller_id);return{...n,seller:r||null,offer:t.find(s=>s.prospection_id===n.id),statusObject:n.status?{...Y.find(s=>s.key===n.status)}:null}});var c=p(4341),b=p(1997),x=p(6389),w=p(5930);let ge=(()=>{class o{constructor(t,n,r){this.fb=t,this.modal=n,this.store=r,this.form=this.fb.group({city:["",c.k0.required],address:[""],price:[null]})}create(){this.form.valid&&(this.store.dispatch(N({prospection:this.form.value})),this.modal.close())}close(){this.modal.close()}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(c.ok),e.rXU(k.J9),e.rXU(i.il))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-create-prospection"]],standalone:!0,features:[e.aNF],decls:16,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","city"],["id","city","formControlName","city"],["for","address"],["id","address","formControlName","address"],["for","price"],["id","price","type","number","formControlName","price"],["for","resume"],["id","resume","type","text","formControlName","resume"],[1,"footer"],["nz-button","","nzType","primary","type","submit",3,"click"]],template:function(n,r){1&n&&(e.j41(0,"form",0)(1,"label",1),e.EFF(2,"City:"),e.k0s(),e.nrm(3,"input",2),e.j41(4,"label",3),e.EFF(5,"Address:"),e.k0s(),e.nrm(6,"input",4),e.j41(7,"label",5),e.EFF(8,"Price:"),e.k0s(),e.nrm(9,"input",6),e.j41(10,"label",7),e.EFF(11,"Description:"),e.k0s(),e.nrm(12,"textarea",8),e.k0s(),e.j41(13,"div",9)(14,"button",10),e.bIt("click",function(){return r.create()}),e.EFF(15,"Create"),e.k0s()()),2&n&&e.Y8G("formGroup",r.form)},dependencies:[c.X1,c.qT,c.me,c.Q0,c.BC,c.cb,c.j4,c.JD,b.DH,g.Zw,g.aO,x.c,w.p],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}div[_ngcontent-%COMP%]{margin-bottom:10px}label[_ngcontent-%COMP%]{margin-right:10px}button[_ngcontent-%COMP%]{margin-top:10px}"]})}}return o})(),ke=(()=>{class o{constructor(){}static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var D=p(9079);const J=(0,i.VP)("[Seller] Load Sellers"),Z=(0,i.VP)("[Seller] Load Sellers Success",(0,i.xk)()),Ce=(0,i.VP)("[Seller] Load Sellers Failure",(0,i.xk)()),K=(0,i.VP)("[Seller] Create Seller",(0,i.xk)()),V=(0,i.VP)("[Seller] Create Seller Success",(0,i.xk)()),Se=(0,i.VP)("[Seller] Create Seller Failure",(0,i.xk)()),Q=(0,i.VP)("[Seller] Update Seller",(0,i.xk)()),O=(0,i.VP)("[Seller] Update Seller Success",(0,i.xk)()),_e=(0,i.VP)("[Seller] Update Seller Failure",(0,i.xk)()),W=(0,i.VP)("[Seller] Remove Seller",(0,i.xk)()),q=(0,i.VP)("[Seller] Remove Seller Success",(0,i.xk)()),Fe=(0,i.VP)("[Seller] Remove Seller Failure",(0,i.xk)());let j=(()=>{class o extends ke{constructor(t,n){super(),this.store=t,this.actions$=n}createSeller(t){return this.store.dispatch(K({seller:t})),(0,D.ot)(this.actions$.pipe((0,a.gp)(V),(0,m.T)(n=>n.seller)))}removeSeller(t){this.store.dispatch(W({id:t.id}))}getSellers(){return this.store.selectSignal(A)}updateSeller(t){return this.store.dispatch(Q({seller:t})),this.actions$.pipe((0,a.gp)(O),(0,m.T)(n=>n.seller))}setSeller(t,n){this.store.dispatch(P({id:t.id,changes:{seller_id:n.id}}))}setSellerSuccess(){return(0,D.ot)(this.actions$.pipe((0,a.gp)(z),(0,f.W)(()=>(0,v.of)(!1)),(0,m.T)(()=>!0)))}setSellerFailure(){return(0,D.ot)(this.actions$.pipe((0,a.gp)(I),(0,m.T)(()=>!0)))}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(i.il),e.KVO(a.En))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),ee=(()=>{class o{constructor(t,n,r){this.fb=t,this.modal=n,this.prospectionFacade=r,this.form=this.fb.group({name:["",c.k0.required],email:["",[c.k0.required,c.k0.email]],phone:["",c.k0.required],address:[""],agency:[""]})}create(){this.form.valid&&(this.prospectionFacade.createSeller(this.form.value),this.modal.close())}close(){this.modal.close()}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(c.ok),e.rXU(k.J9),e.rXU(j))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-create-seller-popup"]],standalone:!0,features:[e.aNF],decls:19,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["id","name","formControlName","name"],["for","email"],["id","email","formControlName","email"],["for","phone"],["id","phone","formControlName","phone"],["for","agency"],["id","agency","formControlName","agency"],["for","address"],["id","address","formControlName","address"],[1,"footer"],["nz-button","","nzType","primary","type","submit",3,"click"]],template:function(n,r){1&n&&(e.j41(0,"form",0)(1,"label",1),e.EFF(2,"Name:"),e.k0s(),e.nrm(3,"input",2),e.j41(4,"label",3),e.EFF(5,"Email:"),e.k0s(),e.nrm(6,"input",4),e.j41(7,"label",5),e.EFF(8,"Phone:"),e.k0s(),e.nrm(9,"input",6),e.j41(10,"label",7),e.EFF(11,"Agence:"),e.k0s(),e.nrm(12,"input",8),e.j41(13,"label",9),e.EFF(14,"Adresse:"),e.k0s(),e.nrm(15,"input",10),e.k0s(),e.j41(16,"div",11)(17,"button",12),e.bIt("click",function(){return r.create()}),e.EFF(18,"Create"),e.k0s()()),2&n&&e.Y8G("formGroup",r.form)},dependencies:[c.X1,c.qT,c.me,c.BC,c.cb,c.j4,c.JD,b.DH,g.Zw,g.aO,x.c,w.p],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column}div[_ngcontent-%COMP%]{margin-bottom:10px}label[_ngcontent-%COMP%]{margin-right:10px}button[_ngcontent-%COMP%]{margin-top:10px}"]})}}return o})();var E=p(4191),y=p(1868),_=p(2602),te=p(5154),Pe=p(1413),be=p(6977);let xe=(()=>{class o{constructor(t,n,r){this.data=t,this.modal=n,this.prospectionFacade=r,this.seller=this.data.seller,this.formGroup=new c.gE({displayName:new c.MJ(this.seller.displayName),address:new c.MJ(this.seller.address),email:new c.MJ(this.seller.email),phone:new c.MJ(this.seller.phone)}),this.destroyComponent$=new Pe.B}ngOnInit(){this.formGroup.valueChanges.pipe((0,be.Q)(this.destroyComponent$),(0,F.M)(t=>{const n={...this.seller,...t,name:t.displayName};this.prospectionFacade.updateSeller(n)})).subscribe()}close(){this.modal.close()}ngOnDestroy(){this.destroyComponent$.next(),this.destroyComponent$.complete()}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(k.or),e.rXU(k.J9),e.rXU(j))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["show-seller-contact-popup"]],standalone:!0,features:[e.Jv_([j]),e.aNF],decls:17,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],[1,"row"],["for","name"],["type","text","formControlName","displayName",1,"form-control"],["type","text","formControlName","address",1,"form-control"],["type","text","formControlName","email",1,"form-control"],["type","text","formControlName","phone",1,"form-control"]],template:function(n,r){1&n&&(e.j41(0,"form",0)(1,"div",1)(2,"div",2),e.EFF(3,"Nom"),e.k0s(),e.nrm(4,"input",3),e.k0s(),e.j41(5,"div",1)(6,"div",2),e.EFF(7,"Adresse"),e.k0s(),e.nrm(8,"input",4),e.k0s(),e.j41(9,"div",1)(10,"div",2),e.EFF(11,"Email"),e.k0s(),e.nrm(12,"input",5),e.k0s(),e.j41(13,"div",1)(14,"div",2),e.EFF(15,"T\xe9l\xe9phone"),e.k0s(),e.nrm(16,"input",6),e.k0s()()),2&n&&e.Y8G("formGroup",r.formGroup)},dependencies:[c.X1,c.qT,c.me,c.BC,c.cb,c.j4,c.JD,b.DH,g.Zw],styles:[".row[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin-bottom:10px}.row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{font-weight:700;width:150px}"]})}}return o})();function je(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",6),e.EFF(1),e.k0s(),e.j41(2,"nz-dropdown-menu",null,1)(4,"ul",4)(5,"li",7),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.showContact())}),e.EFF(6,"voir contact"),e.k0s(),e.j41(7,"li",8),e.EFF(8,"changer le vendeur"),e.k0s()()()}if(2&o){let t;const n=e.sdS(3),r=e.XpG(),s=e.sdS(4);e.Y8G("nzDropdownMenu",n)("nzTrigger","click")("nzOverlayClassName","customContainer"),e.R7$(),e.JRh(null==(t=r.prospection().seller)?null:t.displayName),e.R7$(6),e.Y8G("nzDropdownMenu",s)}}function ye(o,l){if(1&o&&(e.j41(0,"div",2),e.EFF(1,"+"),e.k0s()),2&o){e.XpG();const t=e.sdS(4);e.Y8G("nzTrigger","click")("nzDropdownMenu",t)}}function ze(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",9),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.create())}),e.EFF(1,"+"),e.k0s()}}function Te(o,l){if(1&o){const t=e.RV6();e.j41(0,"li",10),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.setSeller(r))}),e.j41(1,"div",11)(2,"div"),e.EFF(3),e.k0s(),e.j41(4,"div",12),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.removeSeller(r))}),e.k0s()()()}if(2&o){const t=l.$implicit;e.R7$(3),e.JRh(t.displayName)}}let $e=(()=>{class o{constructor(t,n){this.prospectionFacade=t,this.nzModalService=n,this.prospection=e.hFB.required(),this.sellers=this.prospectionFacade.getSellers()}setSeller(t){this.prospectionFacade.setSeller(this.prospection(),t)}create(){this.nzModalService.create({nzTitle:"Create Seller",nzContent:ee,nzFooter:null})}showContact(){this.nzModalService.create({nzTitle:"Contact",nzContent:xe,nzFooter:null,nzData:{seller:this.prospection().seller}})}removeSeller(t){this.prospectionFacade.removeSeller(t)}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(j),e.rXU(k.N_))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["sellers-cell"]],inputs:{prospection:[1,"prospection"]},decls:8,vars:1,consts:[["sellersDropDown","nzDropdownMenu"],["menuSellerDropdown","nzDropdownMenu"],["nz-dropdown","",1,"empty-field","clickable",3,"nzTrigger","nzDropdownMenu"],[1,"empty-field","create","clickable"],["nz-menu","","nzSelectable","",1,"sellers"],["nz-menu-item",""],["nz-dropdown","",1,"seller-name","clickable",3,"nzDropdownMenu","nzTrigger","nzOverlayClassName"],["nz-menu-item","",1,"clickable",3,"click"],["nz-menu-item","","nz-dropdown","",1,"clickable",3,"nzDropdownMenu"],[1,"empty-field","create","clickable",3,"click"],["nz-menu-item","",3,"click"],[1,"seller-item"],["nz-icon","","nzType","delete",1,"delete",3,"click"]],template:function(n,r){1&n&&(e.DNE(0,je,9,5)(1,ye,2,2,"div",2)(2,ze,2,0,"div",3),e.j41(3,"nz-dropdown-menu",null,0)(5,"ul",4),e.Z7z(6,Te,5,1,"li",5,e.fX1),e.k0s()()),2&n&&(e.vxM(r.prospection().seller?0:r.sellers().length?1:2),e.R7$(6),e.Dyx(r.sellers()))},dependencies:[x.c,E.Dn,y.jS,y.CU,_.j3,_.wQ],styles:["[_nghost-%COMP%]{min-width:100px!important;width:100px!important;display:flex}.seller-name[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:100px;display:inline-block}.empty-field[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:center;align-items:center;gap:10px;width:100%;height:100%;padding:0 10px;border-radius:5px}.sellers[_ngcontent-%COMP%]{min-width:100px!important}.seller-item[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;gap:10px;width:100%;min-width:100px;border-radius:5px}"]})}}return o})();const oe=o=>({"background-color":o});function we(o,l){if(1&o){const t=e.RV6();e.j41(0,"td",14),e.bIt("click",function(){e.eBV(t);const r=e.sdS(4),s=e.XpG().$implicit,d=e.XpG();return e.Njj(d.startEdit(s.id+"link",r))}),e.j41(1,"div",15),e.EFF(2),e.k0s(),e.j41(3,"input",16,5),e.bIt("blur",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.editLink=!1)})("blur",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.stopEdit())})("change",function(){e.eBV(t);const r=e.sdS(4),s=e.XpG().$implicit,d=e.XpG();return e.Njj(d.edit(s,"link",r))}),e.k0s()()}if(2&o){const t=e.XpG().$implicit,n=e.XpG();e.R7$(),e.Y8G("hidden",n.editId===t.id+"link"),e.R7$(),e.JRh(t.link),e.R7$(),e.Y8G("value",t.link)("hidden",n.editId!==t.id+"link")}}function De(o,l){if(1&o){const t=e.RV6();e.j41(0,"td")(1,"div",30)(2,"a",31),e.EFF(3,"lien vers l'annonce"),e.k0s()(),e.j41(4,"nz-dropdown-menu",32,6)(6,"ul",33)(7,"li",26),e.bIt("click",function(){e.eBV(t);const r=e.XpG(2);return e.Njj(r.editLink=!0)}),e.EFF(8,"editer"),e.k0s()()()()}if(2&o){const t=e.sdS(5),n=e.XpG().$implicit;e.R7$(),e.Y8G("nzDropdownMenu",t),e.R7$(),e.Y8G("href",n.link,e.B4B)}}function Ve(o,l){if(1&o&&(e.j41(0,"div",34)(1,"span",35),e.EFF(2),e.k0s(),e.nrm(3,"div",36),e.k0s()),2&o){const t=e.XpG().$implicit,n=e.sdS(37);e.Aen(e.eq3(8,oe,null==t.statusObject?null:t.statusObject.color)),e.Y8G("nzDropdownMenu",n)("nzTrigger","click"),e.R7$(),e.Y8G("nzTooltipTitle",null==t.statusObject?null:t.statusObject.label),e.R7$(),e.JRh(null==t.statusObject?null:t.statusObject.shortLabel),e.R7$(),e.Y8G("nzType",null==t.statusObject?null:t.statusObject.icon)("nzTheme",null==t.statusObject?null:t.statusObject.iconTheme)}}function Oe(o,l){if(1&o&&(e.j41(0,"div",22),e.EFF(1," +"),e.k0s()),2&o){e.XpG();const t=e.sdS(37);e.Y8G("nzDropdownMenu",t)("nzTrigger","click")}}function Ee(o,l){if(1&o){const t=e.RV6();e.j41(0,"ul",29),e.nrm(1,"div",37),e.j41(2,"li",26),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG().$implicit,d=e.XpG();return e.Njj(d.setStatus(s,r.key))}),e.EFF(3),e.k0s()()}if(2&o){const t=l.$implicit;e.R7$(),e.Aen(e.eq3(3,oe,t.color)),e.R7$(2),e.JRh(t.label)}}function Me(o,l){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",14),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.sdS(7),d=e.XpG();return e.Njj(d.startEdit(r.id+"address",s))}),e.j41(4,"div",15),e.EFF(5),e.k0s(),e.j41(6,"input",16,1),e.bIt("blur",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.stopEdit())})("change",function(){const r=e.eBV(t).$implicit,s=e.sdS(7),d=e.XpG();return e.Njj(d.edit(r,"address",s))}),e.k0s()(),e.DNE(8,we,5,4,"td",17)(9,De,9,2,"td"),e.j41(10,"td"),e.nrm(11,"sellers-cell",18),e.k0s(),e.j41(12,"td",19),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.sdS(16),d=e.XpG();return e.Njj(d.startEdit(r.id+"price",s))}),e.j41(13,"div",15),e.EFF(14),e.k0s(),e.j41(15,"input",20,2),e.bIt("blur",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.stopEdit())})("change",function(){const r=e.eBV(t).$implicit,s=e.sdS(16),d=e.XpG();return e.Njj(d.edit(r,"price",s))}),e.k0s()(),e.j41(17,"td"),e.EFF(18),e.nI1(19,"date"),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.DNE(23,Ve,4,10,"div",21)(24,Oe,2,2,"div",22),e.k0s(),e.j41(25,"td")(26,"div",23),e.nrm(27,"div",24),e.j41(28,"nz-dropdown-menu",null,3)(30,"ul",25)(31,"li",26),e.bIt("click",function(){const r=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.remove(r))}),e.j41(32,"div",27)(33,"div"),e.EFF(34,"Supprimer"),e.k0s(),e.nrm(35,"i",28),e.k0s()()()()()(),e.j41(36,"nz-dropdown-menu",null,4),e.Z7z(38,Ee,4,5,"ul",29,e.fX1),e.k0s()()}if(2&o){const t=l.$implicit,n=e.sdS(29),r=e.XpG();e.R7$(2),e.JRh(t.city),e.R7$(2),e.Y8G("hidden",r.editId===t.id+"address"),e.R7$(),e.JRh(t.address),e.R7$(),e.Y8G("value",t.address)("hidden",r.editId!==t.id+"address"),e.R7$(2),e.vxM(r.editLink?8:9),e.R7$(3),e.Y8G("prospection",t),e.R7$(2),e.Y8G("hidden",r.editId===t.id+"price"),e.R7$(),e.JRh(t.price),e.R7$(),e.Y8G("value",t.price)("hidden",r.editId!==t.id+"price"),e.R7$(3),e.JRh(e.i5U(19,17,t.emission_date,"dd/MM/YYYY")),e.R7$(3),e.SpI(" ",null==t||null==t.offer?null:t.offer.price," "),e.R7$(2),e.vxM(t.status?23:24),e.R7$(4),e.Y8G("nzDropdownMenu",n)("nzTrigger","click"),e.R7$(3),e.Y8G("id","prospection_actions_dropdown_"+t.id),e.R7$(8),e.Dyx(r.prospectionStatuses)}}const Ge=[{path:"",component:(()=>{class o{constructor(t,n){this.store=t,this.modalService=n,this.prospections=this.store.selectSignal(fe),this.prospectionStatuses=Y,this.hoveredRow=null,this.editLink=!1,this.store.dispatch(G())}openCreatePropspectionPopup(){this.modalService.create({nzTitle:"Create Prospection",nzContent:ge,nzFooter:null})}openCreateSellerPopup(){this.modalService.create({nzTitle:"Create Seller",nzContent:ee,nzFooter:null})}remove(t){null!=t.id&&this.store.dispatch(L({id:t.id}))}setStatus(t,n){null!=t.id&&this.store.dispatch(P({id:t.id,changes:{status:n}}))}startEdit(t,n){this.editId=t,setTimeout(()=>{requestAnimationFrame(()=>{n.focus()})},0)}edit(t,n,r){if(null==t.id)return;const s={id:t.id};s[n]=r.value,this.store.dispatch(P({id:t.id,changes:s}))}stopEdit(){this.editId=null}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(i.il),e.rXU(k.N_))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-prospections"]],decls:32,vars:2,consts:[["tables",""],["editableAddressInput",""],["editablePriceInput",""],["actionsDropdown",""],["prospectionStatus",""],["editableLinkInput",""],["linkDropdown",""],[1,"table-component"],[1,"container"],[1,"header"],["nz-button","","nzType","default",3,"click"],[1,"table-container"],[3,"nzData"],[4,"ngFor","ngForOf"],[1,"editable-cell-number","clickable","field-medium",3,"click"],[3,"hidden"],["nz-demo-input-text-basic","","type","text",3,"blur","change","value","hidden"],[1,"editable-cell-number","clickable","field-medium"],[3,"prospection"],[1,"editable-cell-number","clickable",3,"click"],["nz-demo-input-text-basic","","type","number",3,"blur","change","value","hidden"],["nz-dropdown","",1,"status","clickable",3,"nzDropdownMenu","nzTrigger","style"],["nz-dropdown","",1,"empty-field","clickable",3,"nzDropdownMenu","nzTrigger"],[1,"action"],["nz-dropdown","","nz-icon","","nzType","tool","nzTheme","fill",1,"tool",3,"nzDropdownMenu","nzTrigger"],["nz-menu","",3,"id"],["nz-menu-item","",3,"click"],[1,"dropdown-item"],["nz-icon","","nzType","delete","nzTheme","fill"],["nz-menu","",1,"status-item"],["nz-dropdown","",1,"clickable",3,"nzDropdownMenu"],["target","_blank",3,"href"],["nz-dropdown-menu",""],["nz-menu",""],["nz-dropdown","",1,"status","clickable",3,"nzDropdownMenu","nzTrigger"],["nz-tooltip","",3,"nzTooltipTitle"],["nz-icon","",3,"nzType","nzTheme"],[1,"color-indicator"]],template:function(n,r){if(1&n){const s=e.RV6();e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"button",10),e.bIt("click",function(){return e.eBV(s),e.Njj(r.openCreatePropspectionPopup())}),e.EFF(4,"Ajouter un bien en prospection"),e.k0s(),e.j41(5,"button",10),e.bIt("click",function(){return e.eBV(s),e.Njj(r.openCreateSellerPopup())}),e.EFF(6,"Ajouter un vendeur / agent"),e.k0s()(),e.j41(7,"div",11)(8,"nz-table",12,0)(10,"thead")(11,"tr")(12,"th"),e.EFF(13,"ville"),e.k0s(),e.j41(14,"th"),e.EFF(15,"adresse"),e.k0s(),e.j41(16,"th"),e.EFF(17,"lien"),e.k0s(),e.j41(18,"th"),e.EFF(19,"vendeur"),e.k0s(),e.j41(20,"th"),e.EFF(21,"prix"),e.k0s(),e.j41(22,"th"),e.EFF(23,"parution"),e.k0s(),e.j41(24,"th"),e.EFF(25,"offre"),e.k0s(),e.j41(26,"th"),e.EFF(27,"status"),e.k0s(),e.j41(28,"th"),e.EFF(29,"actions"),e.k0s()()(),e.j41(30,"tbody"),e.DNE(31,Me,40,20,"tr",13),e.k0s()()()()()}if(2&n){const s=e.sdS(9);e.R7$(8),e.Y8G("nzData",r.prospections()),e.R7$(23),e.Y8G("ngForOf",s.data)}},dependencies:[S.Sq,g.aO,x.c,w.p,C.CP,C.SO,C._4,C.IL,C.aj,C.kt,E.Dn,y.jS,y.CU,_.j3,_.wQ,te.LH,$e,S.vh],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-flow:column nowrap;align-items:center;justify-content:center;padding:20px}.container[_ngcontent-%COMP%]{width:100%}.tool[_ngcontent-%COMP%]{padding:2px;color:var(--ant-danger-color)}.dropdown-item[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:space-between;gap:10px;min-width:200px;width:100%}.color-indicator[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:6px;height:100%;border-radius:0 5px 5px 0}.status-item[_ngcontent-%COMP%]{padding-left:26px}.status[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:space-between;align-items:center;gap:10px;width:100%;height:100%;padding:0 10px;border-radius:5px;position:relative;color:#fff}.empty-field[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;justify-content:center;align-items:center;gap:10px;width:100%;height:100%;padding:0 10px;border-radius:5px}"]})}}return o})()}];let Re=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[B.iI.forChild(Ge),B.iI]})}}return o})(),Ne=(()=>{class o{constructor(t){this.http=t,this.apiUrl=`${T.c.apiURL}/prospections/sellers`}getAll(){return this.http.get(`${this.apiUrl}/all`)}getById(t){return this.http.get(`${this.apiUrl}/${t}`)}create(t){return this.http.post(this.apiUrl,t)}update(t,n){return this.http.patch(`${this.apiUrl}/${t}`,n)}delete(t){return this.http.delete(`${this.apiUrl}/${t}`)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO($.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),Ue=(()=>{class o{constructor(t,n){this.actions$=t,this.sellerService=n,this.loadSellers$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(J),(0,h.Z)(()=>this.sellerService.getAll().pipe((0,m.T)(r=>Z({sellers:r})),(0,f.W)(r=>(0,v.of)(Ce({error:r}))))))),this.addSeller$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(K),(0,h.Z)(r=>this.sellerService.create(r.seller).pipe((0,m.T)(s=>V({seller:s})),(0,f.W)(s=>(0,v.of)(Se({error:s}))))))),this.updateSeller$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(Q),(0,h.Z)(r=>this.sellerService.update(r.seller?.id,r.seller).pipe((0,m.T)(s=>O({seller:s})),(0,f.W)(s=>(0,v.of)(_e({error:s}))))))),this.removeSeller$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(W),(0,h.Z)(r=>this.sellerService.delete(r.id).pipe((0,m.T)(()=>q({id:r.id})),(0,f.W)(s=>(0,v.of)(Fe({error:s})))))))}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(a.En),e.KVO(Ne))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac})}}return o})();const Xe=(0,i.vy)({sellers:[]},(0,i.on)(Z,(o,{sellers:l})=>({...o,sellers:l})),(0,i.on)(V,(o,{seller:l})=>({...o,sellers:[...o.sellers,l]})),(0,i.on)(q,(o,{id:l})=>({...o,sellers:o.sellers.filter(t=>t.id!==l)})),(0,i.on)(O,(o,{seller:l})=>({...o,sellers:o.sellers.map(t=>t.id===l.id?l:t)})));let Ie=(()=>{class o{constructor(t){this.store=t,this.store.dispatch(J())}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(i.il))}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[S.MD,i.md.forFeature("sellers",Xe),a.Vm.forFeature(Ue)]})}}return o})();const ne=(0,i.VP)("[Offers] Load Offers"),re=(0,i.VP)("[Offers] Load Offers Success",(0,i.xk)()),Be=(0,i.VP)("[Offers] Load Offers Failure",(0,i.xk)());let Ae=(()=>{class o{constructor(t){this.http=t}getAll(){return this.http.get(`${T.c.apiURL}/prospections/offers/get`)}static{this.\u0275fac=function(n){return new(n||o)(e.KVO($.Qq))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})(),Ye=(()=>{class o{constructor(t,n){this.actions$=t,this.offersHttpService=n,this.loadOffers$=(0,a.EH)(()=>this.actions$.pipe((0,a.gp)(ne),(0,h.Z)(()=>this.offersHttpService.getAll().pipe((0,m.T)(r=>re({offers:r})),(0,f.W)(r=>(0,v.of)(Be({error:r})))))))}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(a.En),e.KVO(Ae))}}static{this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac})}}return o})();const Je=(0,i.vy)({offers:[]},(0,i.on)(re,(o,{offers:l})=>({...o,offers:l})));let Ze=(()=>{class o{constructor(t){this.store=t,this.store.dispatch(ne())}static{this.\u0275fac=function(n){return new(n||o)(e.KVO(i.il))}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[S.MD,i.md.forFeature("offers",Je),a.Vm.forFeature(Ye)]})}}return o})(),Ke=(()=>{class o{static{this.\u0275fac=function(n){return new(n||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[S.MD,Re,i.md.forFeature("prospections",de),a.Vm.forFeature(pe),Ie,Ze,g.Zw,k.U6,C.$G,ie.GP,E.Y3,_.Cu,b.DH,te.Qt]})}}return o})()}}]);