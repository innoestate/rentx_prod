"use strict";(self.webpackChunkangular=self.webpackChunkangular||[]).push([[391],{1257:(z,D,t)=>{t.d(D,{t:()=>R});var e=t(4438),n=t(431),i=t(1281),r=t(496),h=t(9640),E=t(3390),s=t(1747),u=t(5458);let R=(()=>{class O{constructor(v,f,M,d){this.store=v,this.modalService=f,this.actions$=M,this.rentService=d,this.estate=e.hFB.required(),this.lodgers=this.store.selectSignal(r.T)}downloadCustomizedRentReceipt(){this.rentService.downloadCustomizedRentReceipt(this.estate())}downloadRentReceipt(){this.rentService.downloadRentReceipt(this.estate())}senddRentReceipt(){this.rentService.sendRentReceiptByEmail(this.estate())}createLodger(){this.rentService.openCreateLodgerPopup(this.estate())}setLodger(v){this.store.dispatch((0,n.dG)({estate:{id:this.estate().id,lodger_id:v?.id??""}}))}deleteLodger(v){this.store.dispatch((0,i.rX)({lodgerId:v.id}))}static{this.\u0275fac=function(f){return new(f||O)(e.rXU(h.il),e.rXU(E.N_),e.rXU(s.En),e.rXU(u.t))}}static{this.\u0275dir=e.FsC({type:O,inputs:{estate:[1,"estate"]}})}}return O})()},3457:(z,D,t)=>{t.d(D,{N:()=>O});var e=t(4438),n=t(7462),i=t(7498),r=t(431),h=t(889),E=t(1176),s=t(9640),u=t(3390),R=t(1747);let O=(()=>{class P{constructor(f,M,d){this.store=f,this.modalService=M,this.actions$=d,this.estate=e.hFB.required(),this.owners=this.store.selectSignal(E.P)}openCreateOwnerPopup(){this.modalService.create({nzTitle:"Ajouter un nouveau propri\xe9taire",nzContent:n.X,nzFooter:null})}openEditOwnerPopup(f){this.modalService.create({nzTitle:"\xe9ditier un propri\xe9taire",nzContent:i.r,nzData:{owner:f},nzFooter:null})}createOwner(f){this.openCreateOwnerPopup()}setOwner(f,M){this.store.dispatch((0,r.dG)({estate:{...f,owner_id:M.id}}))}deleteOwner(f){this.store.dispatch((0,h.HD)({ownerId:f.id}))}editOwner(f){this.openEditOwnerPopup(f)}static{this.\u0275fac=function(M){return new(M||P)(e.rXU(s.il),e.rXU(u.N_),e.rXU(R.En))}}static{this.\u0275dir=e.FsC({type:P,inputs:{estate:[1,"estate"]}})}}return P})()},370:(z,D,t)=>{t.d(D,{y:()=>A});var e=t(431),n=t(9640);const E=c=>{const m=new Date;let l=!1;return c.forEach(y=>{m.getFullYear()===y.year&&m.getMonth()===y.month&&(l=!0)}),l},s=c=>{const m=new Date;return!!c.find(y=>y.year===m.getFullYear()&&y.month===m.getMonth())?.sent},u=(0,n.UX)("estates"),R=(0,n.UX)("owners"),O=(0,n.UX)("lodgers"),P=(0,n.UX)("rents"),v=(0,n.Mz)(u,R,O,P,(c,m,l,y)=>((c,m,l,y)=>c.map(w=>((c,m,l,y)=>({...c,address:c.street+" "+c.city+" "+c.zip,plot_address:c.plot?"LOT "+c.plot+" / "+c.street+" "+c.city+" "+c.zip:c.street+" "+c.city+" "+c.zip,owner:m.find(w=>w.id+""==c.owner_id+""),lodger:l.find(w=>w.id+""==c.lodger_id+""),rents:y,actualMonthPaid:E(y),rentReceiptSentByEmail:s(y)}))(w,m,l,y.find(S=>S.estateId===w.id)?.rents??[])))(c.estates,m.owners,l.lodgers,y.monthlyRents_Dto));var f=t(496),M=t(1176),d=t(4341),T=t(513),g=t(1997),a=t(4438);let L=(()=>{class c{constructor(l,y){this.formBuilder=l,this.store=y,this.owners=this.store.selectSignal(M.P)}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({street:new d.MJ("",[d.k0.required]),city:new d.MJ("",[d.k0.required]),zip:new d.MJ("",[d.k0.required]),plot:new d.MJ(""),rent:new d.MJ(0),charges:new d.MJ(0),owner:new d.MJ(this.owners().length?this.owners()[0].id:null),lodger:new d.MJ("")})}create(){if(this.formGroup.invalid)return;const l=(c=>{let m=c.get("owner")?.value;return"string"!=typeof m&&"number"!=typeof m&&m&&(m=c.get("owner")?.value?.id),{street:c.get("street").value,city:c.get("city").value,zip:c.get("zip").value,plot:c.get("plot")?.value,rent:c.get("rent")?.value,charges:c.get("charges")?.value,owner_id:m,lodger_id:c.get("lodger")?.value}})(this.formGroup);this.store.dispatch((0,e.l6)({estate:l}))}static{this.\u0275fac=function(y){return new(y||c)(a.rXU(d.ok),a.rXU(n.il))}}static{this.\u0275dir=a.FsC({type:c})}}return c})();var I=t(6389),C=t(5930);function U(c,m){if(1&c&&a.nrm(0,"nz-option",8),2&c){const l=m.$implicit;a.Y8G("nzValue",l.id)("nzLabel",l.name)}}let o=(()=>{class c extends L{static{this.\u0275fac=(()=>{let l;return function(w){return(l||(l=a.xGo(c)))(w||c)}})()}static{this.\u0275cmp=a.VBU({type:c,selectors:[["create-estate-popup"]],standalone:!0,features:[a.Vt3,a.aNF],decls:21,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["type","text","formControlName","plot",1,"form-control"],["for","owner"],["formControlName","owner","nzPlaceHolder","Propri\xe9taire",1,"select"],[3,"nzValue","nzLabel"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(y,w){1&y&&(a.j41(0,"form",0)(1,"label",1),a.EFF(2,"Adresse"),a.k0s(),a.nrm(3,"input",2),a.j41(4,"label",1),a.EFF(5,"Ville"),a.k0s(),a.nrm(6,"input",3),a.j41(7,"label",1),a.EFF(8,"Code Postal"),a.k0s(),a.nrm(9,"input",4),a.j41(10,"label",1),a.EFF(11,"Lot"),a.k0s(),a.nrm(12,"input",5),a.j41(13,"label",6),a.EFF(14,"Propri\xe9taire"),a.k0s(),a.j41(15,"nz-select",7),a.Z7z(16,U,1,2,"nz-option",8,a.fX1),a.k0s()(),a.j41(18,"div",9)(19,"button",10),a.bIt("click",function(){return w.create()}),a.EFF(20,"cr\xe9er"),a.k0s()()),2&y&&(a.Y8G("formGroup",w.formGroup),a.R7$(16),a.Dyx(w.owners()))},dependencies:[d.X1,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,g.DH,g.ld,g.WI,T.Zw,T.aO,I.c,C.p],styles:[".form-group-popup[_ngcontent-%COMP%]{display:flex;flex-flow:column nowrap;justify-content:flex-start;align-items:flex-start}"]})}}return c})();var F=t(3390),p=t(1747),$=t(8113);let A=(()=>{class c{constructor(l,y,w,S){this.store=l,this.modalService=y,this.actions$=w,this.rentHttpService=S,this.owners=this.store.selectSignal(M.P),this.lodgers=this.store.selectSignal(f.T),this.estates=this.store.selectSignal(v)}ngOnInit(){this.store.dispatch((0,e.kW)())}synchronizeGoogleSheet(){this.rentHttpService.synchronizeGoogleSheet().subscribe()}openCreateEstatePopup(){this.modalService.create({nzTitle:"Cr\xe9er un nouveau bien",nzContent:o,nzFooter:null})}startEdit(l,y){this.editId=l,setTimeout(()=>{requestAnimationFrame(()=>{y.focus()})},0)}stopEdit(){this.editId=null}edit(l,y,w){const S={id:l.id};S[y]=w.value,this.store.dispatch({type:"[Estates] Edit Estate",estate:S})}deleteEstate(l){this.store.dispatch((0,e.su)({estateId:l.id}))}static{this.\u0275fac=function(y){return new(y||c)(a.rXU(n.il),a.rXU(F.N_),a.rXU(p.En),a.rXU($.M))}}static{this.\u0275dir=a.FsC({type:c})}}return c})()},7462:(z,D,t)=>{t.d(D,{X:()=>v});var e=t(4341),n=t(889),i=t(2062),r=t(4438),h=t(9640);let E=(()=>{class f{constructor(d,T){this.formBuilder=d,this.store=T}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({name:new e.MJ("",[e.k0.required]),street:new e.MJ("",[e.k0.required]),city:new e.MJ("",[e.k0.required]),zip:new e.MJ("",[e.k0.required]),signature:new e.MJ("")})}create(){if(this.formGroup.invalid)return;const d=(0,i.g)(this.formGroup);this.store.dispatch((0,n.lv)({owner:d}))}static{this.\u0275fac=function(T){return new(T||f)(r.rXU(e.ok),r.rXU(h.il))}}static{this.\u0275dir=r.FsC({type:f})}}return f})();var s=t(1997),u=t(513),R=t(8468),O=t(6389),P=t(5930);let v=(()=>{class f extends E{static{this.\u0275fac=(()=>{let d;return function(g){return(d||(d=r.xGo(f)))(g||f)}})()}static{this.\u0275cmp=r.VBU({type:f,selectors:[["app-create-owner-popup"]],standalone:!0,features:[r.Vt3,r.aNF],decls:19,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["formControlName","signature"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(T,g){1&T&&(r.j41(0,"form",0)(1,"label",1),r.EFF(2,"Nom et pr\xe9nom"),r.k0s(),r.nrm(3,"input",2),r.j41(4,"label",1),r.EFF(5,"Adresse"),r.k0s(),r.nrm(6,"input",3),r.j41(7,"label",1),r.EFF(8,"Ville"),r.k0s(),r.nrm(9,"input",4),r.j41(10,"label",1),r.EFF(11,"Code Postal"),r.k0s(),r.nrm(12,"input",5),r.j41(13,"label",1),r.EFF(14,"Signature"),r.k0s(),r.nrm(15,"signature-pad",6),r.k0s(),r.j41(16,"div",7)(17,"button",8),r.bIt("click",function(){return g.create()}),r.EFF(18,"cr\xe9er"),r.k0s()()),2&T&&r.Y8G("formGroup",g.formGroup)},dependencies:[e.X1,e.qT,e.me,e.BC,e.cb,e.j4,e.JD,s.DH,u.Zw,u.aO,O.c,P.p,R.u]})}}return f})()},7498:(z,D,t)=>{t.d(D,{r:()=>a});var e=t(4341),n=t(513),i=t(1997),r=t(3390),h=t(889),E=t(2062),s=t(4438),u=t(9640);let R=(()=>{class L{constructor(C,U,o){this.data=C,this.formBuilder=U,this.store=o}ngOnInit(){this.buildFormGroup()}buildFormGroup(){this.formGroup=this.formBuilder.group({name:new e.MJ(this.data?.owner?.name??"",[e.k0.required]),street:new e.MJ(this.data?.owner?.street??""),city:new e.MJ(this.data?.owner?.city??""),zip:new e.MJ(this.data?.owner?.zip??""),signature:new e.MJ(this.data?.owner?.signature??"")})}edit(){if(this.formGroup.invalid)return;const C=(0,E.o)(this.formGroup,this.data.owner.id);this.store.dispatch((0,h.He)({owner:C}))}static{this.\u0275fac=function(U){return new(U||L)(s.rXU(r.or),s.rXU(e.ok),s.rXU(u.il))}}static{this.\u0275dir=s.FsC({type:L})}}return L})();var O=t(8468),P=t(1747),v=t(1413),f=t(6977),M=t(6697),d=t(8141),T=t(6389),g=t(5930);let a=(()=>{class L extends R{constructor(C,U,o,F,p){super(C,U,o),this.data=C,this.formBuilder=U,this.store=o,this.modalRef=F,this.actions$=p,this.destroyed$=new v.B}ngOnInit(){super.ngOnInit(),this.actions$.pipe((0,P.gp)(h.eX),(0,f.Q)(this.destroyed$),(0,M.s)(1),(0,d.M)(()=>this.modalRef.close())).subscribe()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static{this.\u0275fac=function(U){return new(U||L)(s.rXU(r.or),s.rXU(e.ok),s.rXU(u.il),s.rXU(r.J9),s.rXU(P.En))}}static{this.\u0275cmp=s.VBU({type:L,selectors:[["edit-owner-popup"]],standalone:!0,features:[s.Vt3,s.aNF],decls:19,vars:1,consts:[[1,"form-group-popup",3,"formGroup"],["for","name"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","street",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","zip",1,"form-control"],["formControlName","signature"],[1,"footer"],["nz-button","","nzType","primary",3,"click"]],template:function(U,o){1&U&&(s.j41(0,"form",0)(1,"label",1),s.EFF(2,"Nom et pr\xe9nom"),s.k0s(),s.nrm(3,"input",2),s.j41(4,"label",1),s.EFF(5,"Adresse"),s.k0s(),s.nrm(6,"input",3),s.j41(7,"label",1),s.EFF(8,"Ville"),s.k0s(),s.nrm(9,"input",4),s.j41(10,"label",1),s.EFF(11,"Code Postal"),s.k0s(),s.nrm(12,"input",5),s.j41(13,"label",1),s.EFF(14,"Signature"),s.k0s(),s.nrm(15,"signature-pad",6),s.k0s(),s.j41(16,"div",7)(17,"button",8),s.bIt("click",function(){return o.edit()}),s.EFF(18,"\xe9diter"),s.k0s()()),2&U&&s.Y8G("formGroup",o.formGroup)},dependencies:[e.X1,e.qT,e.me,e.BC,e.cb,e.j4,e.JD,i.DH,n.Zw,n.aO,T.c,g.p,O.u]})}}return L})()},2552:(z,D,t)=>{t.d(D,{H:()=>U});var e=t(177),n=t(1747),i=t(9640),r=t(1281),h=t(3993),E=t(6354),s=t(5558),u=t(7673),R=t(9437),O=t(8141),P=t(889),v=t(496),f=t(431),M=t(4438),d=t(5312),T=t(1626);let g=(()=>{class o{constructor(p){this.http=p,this.API_URL=d.c.apiURL}create(p){return this.http.post(`${this.API_URL}/lodgers`,p)}read(){return this.http.get(`${this.API_URL}/lodgers`)}update(p){return this.http.patch(`${this.API_URL}/lodgers`,p)}delete(p){return this.http.delete(`${this.API_URL}/lodgers`,{body:{id:p}}).pipe((0,E.T)(()=>p))}static{this.\u0275fac=function($){return new($||o)(M.KVO(T.Qq))}}static{this.\u0275prov=M.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var a=t(7094);let L=(()=>{class o{constructor(p,$,A,c){this.actions$=p,this.lodgerService=$,this.store=A,this.message=c,this.loadOwners$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.z8),(0,h.E)(this.store.select(v.T)),(0,E.T)(([m,l])=>l),(0,s.n)(m=>m&&m.length>0?(0,u.of)((0,r.Yq)({lodgers:m})):this.lodgerService.read().pipe((0,E.T)(l=>(0,r.Yq)({lodgers:l})),(0,R.W)(l=>(0,u.of)((0,P.fJ)(l))))))),this.createLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.EU),(0,s.n)(({lodger:m,estateId:l})=>this.lodgerService.create(m).pipe((0,E.T)(y=>(l&&this.store.dispatch((0,f.dG)({estate:{id:l,lodger_id:y.id}})),(0,r.B8)({lodger:y}))),(0,R.W)(y=>(0,u.of)((0,r.qU)(y))))))),this.createLodgerSuccess$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.B8),(0,O.M)(()=>this.message.success("locataire ajout\xe9 avec succ\xe8s!"))),{dispatch:!1}),this.createLodgerFailure$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.qU),(0,O.M)(m=>this.message.error(m.error.message))),{dispatch:!1}),this.updateLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.Z1),(0,s.n)(m=>this.lodgerService.update(m.lodger).pipe((0,E.T)(l=>(0,r.YG)({lodger:l})),(0,R.W)(l=>(0,u.of)((0,r.d9)(l))))))),this.deleteLodger$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(r.rX),(0,s.n)(m=>this.lodgerService.delete(m.lodgerId).pipe((0,E.T)(l=>(0,r.CI)({lodgerId:l})),(0,R.W)(()=>(0,u.of)((0,r.CI)(m.ownerId)))))))}static{this.\u0275fac=function($){return new($||o)(M.KVO(n.En),M.KVO(g),M.KVO(i.il),M.KVO(a.xh))}}static{this.\u0275prov=M.jDH({token:o,factory:o.\u0275fac})}}return o})();const C=(0,i.vy)({lodgers:[]},(0,i.on)(r.Yq,(o,{lodgers:F})=>({...o,lodgers:F})),(0,i.on)(r.B8,(o,{lodger:F})=>({...o,lodgers:o.lodgers.concat(F)})),(0,i.on)(r.YG,(o,{lodger:F})=>({...o,lodgers:o.lodgers.map(p=>p.id===F.id?{...p,...F}:p)})),(0,i.on)(r.CI,(o,{lodgerId:F})=>({...o,lodgers:o.lodgers.filter(p=>p.id!==F)})));let U=(()=>{class o{constructor(p,$){this.store=p,this.actions$=$,this.store.dispatch((0,r.z8)())}static{this.\u0275fac=function($){return new($||o)(M.KVO(i.il),M.KVO(n.En))}}static{this.\u0275mod=M.$C({type:o})}static{this.\u0275inj=M.G2t({imports:[e.MD,i.md.forFeature("lodgers",C),n.Vm.forFeature(L)]})}}return o})()},8221:(z,D,t)=>{t.d(D,{j:()=>U});var e=t(177),n=t(1747),i=t(9640),r=t(3993),h=t(6354),E=t(5558),s=t(7673),u=t(9437),R=t(8141),O=t(1176),P=t(889),v=t(4438),f=t(5312),M=t(1626);let d=(()=>{class o{constructor(p){this.http=p,this.API_URL=f.c.apiURL}get(){return this.http.get(`${this.API_URL}/owners`)}create(p){return this.http.post(`${this.API_URL}/owners`,p)}edit(p){return this.http.patch(`${this.API_URL}/owners`,p).pipe((0,h.T)($=>p))}delete(p){return this.http.delete(`${this.API_URL}/owners`,{body:{id:p}}).pipe((0,h.T)($=>p))}static{this.\u0275fac=function($){return new($||o)(v.KVO(M.Qq))}}static{this.\u0275prov=v.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var T=t(7094);let g=(()=>{class o{constructor(p,$,A,c){this.actions$=p,this.ownerService=$,this.store=A,this.message=c,this.loadOwners$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Load Owners"),(0,r.E)(this.store.select(O.P)),(0,h.T)(([m,l])=>l),(0,E.n)(m=>m&&m.length>0?(0,s.of)({type:"[Owners] Load Owners Success",owners:m}):this.ownerService.get().pipe((0,h.T)(l=>({type:"[Owners] Load Owners Success",owners:l})),(0,u.W)(()=>(0,s.of)({type:"[Owners] Load Owners Failure"})))))),this.addOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Add Owner"),(0,E.n)(({owner:m})=>this.ownerService.create(m).pipe((0,h.T)(l=>({type:"[Owners] Add Owner Success",owner:l})),(0,u.W)(()=>(0,s.of)({type:"[Owners] Load Owners Failure"})))))),this.addOwnerSuccess$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(P._P),(0,R.M)(()=>this.message.success("propri\xe9taire ajout\xe9 avec succ\xe8s!"))),{dispatch:!1}),this.addOwnerFailure$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)(P.LM),(0,R.M)(m=>this.message.error(m.error.message))),{dispatch:!1}),this.updateOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Update Owner"),(0,E.n)(({owner:m})=>this.ownerService.edit(m).pipe((0,h.T)(l=>(0,P.eX)({owner:l})),(0,u.W)(()=>(0,s.of)({type:"[Owners] Update Owner Failure"})))))),this.deleteOwner$=(0,n.EH)(()=>this.actions$.pipe((0,n.gp)("[Owners] Delete Owner"),(0,E.n)(m=>this.ownerService.delete(m.ownerId).pipe((0,h.T)(l=>({type:"[Owners] Delete Owner Success",ownerId:l})),(0,u.W)(()=>(0,s.of)({type:"[Owners] Delete Owner Failure"}))))))}static{this.\u0275fac=function($){return new($||o)(v.KVO(n.En),v.KVO(d),v.KVO(i.il),v.KVO(T.xh))}}static{this.\u0275prov=v.jDH({token:o,factory:o.\u0275fac})}}return o})();const L=(0,i.vy)({owners:[]},(0,i.on)(P.Ju,(o,F)=>({...o})),(0,i.on)(P.kN,(o,F)=>({...o,owners:F.owners})),(0,i.on)(P.fJ,(o,F)=>({...o})),(0,i.on)(P.lv,(o,F)=>({...o})),(0,i.on)(P._P,(o,F)=>({...o,owners:o.owners.concat(F.owner)})),(0,i.on)(P.LM,(o,F)=>({...o})),(0,i.on)(P.HD,(o,F)=>({...o})),(0,i.on)(P.eX,(o,{owner:F})=>({...o,owners:o.owners.map(p=>p.id===F.id?{...p,...F}:p)})),(0,i.on)(P.ye,(o,{ownerId:F})=>({...o,owners:o.owners.filter(p=>p.id!==F)})),(0,i.on)(P.XB,(o,F)=>({...o})));var I=t(3456),C=t(6697);let U=(()=>{class o{constructor(p,$){this.store=p,this.actions$=$,this.loadOwners()}loadOwners(){this.actions$.pipe((0,n.gp)(I.DP),(0,C.s)(1),(0,R.M)(p=>{this.store.dispatch((0,P.Ju)())})).subscribe()}static{this.\u0275fac=function($){return new($||o)(v.KVO(i.il),v.KVO(n.En))}}static{this.\u0275mod=v.$C({type:o})}static{this.\u0275inj=v.G2t({imports:[e.MD,i.md.forFeature("owners",L),n.Vm.forFeature(g)]})}}return o})()},9183:(z,D,t)=>{t.d(D,{X:()=>R});var e=t(177),n=t(1747),i=t(9640),r=t(2440),h=t(1069);const s=(0,i.vy)({monthlyRents_Dto:[]},(0,i.on)(r.Dh,(O,P)=>({monthlyRents_Dto:P.monthlyRents})));var u=t(4438);let R=(()=>{class O{constructor(v,f){this.store=v,this.actions$=f,this.store.dispatch((0,r.Y6)())}static{this.\u0275fac=function(f){return new(f||O)(u.KVO(i.il),u.KVO(n.En))}}static{this.\u0275mod=u.$C({type:O})}static{this.\u0275inj=u.G2t({imports:[e.MD,i.md.forFeature("rents",s),n.Vm.forFeature(h.H)]})}}return O})()},8113:(z,D,t)=>{t.d(D,{M:()=>r});var e=t(5312),n=t(4438),i=t(1626);let r=(()=>{class h{constructor(s){this.http=s,this.API_URL=e.c.apiURL}loadMonthlyRents(){return this.http.get(`${this.API_URL}/rents`)}downloadRentReceipt(s,u,R){let O=`estate=${s}`;return u&&(O+=`&startDate=${u}`),R&&(O+=`&endDate=${R}`),this.http.get(`${this.API_URL}/rents/pdf?${O}`,{responseType:"blob"})}sendRentReceipt(s,u,R){let O=`estate=${s}`;return u&&(O+=`&startDate=${u}`),R&&(O+=`&endDate=${R}`),this.http.get(`${this.API_URL}/rents/email?${O}`)}synchronizeGoogleSheet(){return this.http.get(`${this.API_URL}/rents/sheets`)}static{this.\u0275fac=function(u){return new(u||h)(n.KVO(i.Qq))}}static{this.\u0275prov=n.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},8543:(z,D,t)=>{t.d(D,{u:()=>M});var e=t(1747),n=t(5558),i=t(6354),r=t(9437),h=t(7673),E=t(8141),s=t(431),u=t(4438),R=t(5312),O=t(1626);let P=(()=>{class d{constructor(g){this.http=g,this.API_URL=R.c.apiURL}getEstates(){return this.http.get(`${this.API_URL}/estates`)}create(g){return this.http.post(`${this.API_URL}/estates`,g)}editEstate(g){return this.http.patch(`${this.API_URL}/estate`,g)}deleteEstate(g){return this.http.delete(`${this.API_URL}/estates`,{body:{id:g}})}static{this.\u0275fac=function(a){return new(a||d)(u.KVO(O.Qq))}}static{this.\u0275prov=u.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})();var v=t(8113),f=t(7094);let M=(()=>{class d{constructor(g,a,L,I){this.actions$=g,this.estatesService=a,this.rentsService=L,this.message=I,this.loadEstates$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Load Estates"),(0,n.n)(()=>this.estatesService.getEstates().pipe((0,i.T)(C=>({type:"[Estates] Load Estates Success",estates:C})),(0,r.W)(()=>(0,h.of)({type:"[Estates] Load Estates Failure"})))))),this.createEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Create Estate"),(0,n.n)(({estate:C})=>this.estatesService.create(C).pipe((0,i.T)(U=>({type:"[Estates] Create Estate Success",estate:U})),(0,r.W)(({error:U})=>(0,h.of)({type:"[Estates] Create Estate Failure",error:U})))))),this.createEstateSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.Cs),(0,E.M)(()=>{this.message.success("Bien ajout\xe9 avec succ\xe8s!")})),{dispatch:!1}),this.editEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)("[Estates] Edit Estate"),(0,n.n)(({estate:C})=>this.estatesService.editEstate(C).pipe((0,i.T)(()=>({type:"[Estates] Edit Estate Success",estate:C})),(0,r.W)(()=>(0,h.of)({type:"[Estates] Edit Estate Failure"})))))),this.deleteEstate$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.su),(0,n.n)(({estateId:C})=>this.estatesService.deleteEstate(C).pipe((0,i.T)(()=>(0,s.Ng)({estateId:C})),(0,r.W)(()=>(0,h.of)({type:"[Estates] Delete Estate Failure"}))))))}static{this.\u0275fac=function(a){return new(a||d)(u.KVO(e.En),u.KVO(P),u.KVO(v.M),u.KVO(f.xh))}}static{this.\u0275prov=u.jDH({token:d,factory:d.\u0275fac})}}return d})()},7211:(z,D,t)=>{t.d(D,{i:()=>r});var e=t(9640),n=t(431);const r=(0,e.vy)({estates:[]},(0,e.on)(n.Lj,(h,E)=>({...h,estates:E.estates})),(0,e.on)(n.Cs,(h,E)=>({...h,estates:[...h.estates,E.estate]})),(0,e.on)(n.wP,(h,E)=>({...h,estates:h.estates.map(s=>s.id===E.estate.id?{...s,...E.estate}:s)})),(0,e.on)(n.Ng,(h,{estateId:E})=>({...h,estates:h.estates.filter(s=>s.id!==E)})))},496:(z,D,t)=>{t.d(D,{T:()=>i});var e=t(9640);const n=(0,e.UX)("lodgers"),i=(0,e.Mz)(n,r=>r.lodgers)},1176:(z,D,t)=>{t.d(D,{P:()=>i});var e=t(9640);const n=(0,e.UX)("owners"),i=(0,e.Mz)(n,r=>r.owners)},1069:(z,D,t)=>{t.d(D,{H:()=>P});var e=t(1747),n=t(5558),i=t(8141),r=t(6354),h=t(9437),E=t(7673),s=t(2440),u=t(4438),R=t(8113),O=t(7094);let P=(()=>{class v{constructor(M,d,T){this.actions$=M,this.rentsService=d,this.message=T,this.downloadRentReceipt$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.KP),(0,n.n)(({estateId:g,startDate:a,endDate:L})=>this.rentsService.downloadRentReceipt(g,a,L).pipe((0,i.M)(I=>{const C=window.URL.createObjectURL(I),U=document.createElement("a");U.href=C,U.download="quittance.pdf",U.click(),window.URL.revokeObjectURL(C)}),(0,r.T)(I=>(0,s.n9)()),(0,h.W)(I=>(0,E.of)((0,s.kZ)(I))))))),this.downloadRentReceiptSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.n9),(0,r.T)(g=>(0,s.Y6)()))),this.sendRentReceipt$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.eT),(0,n.n)(({estate:g,startDate:a,endDate:L})=>this.rentsService.sendRentReceipt(g.id,a,L).pipe((0,r.T)(I=>(0,s.tT)({estate:I})),(0,h.W)(I=>(0,E.of)((0,s.eV)(I))))))),this.sendRentReceiptSuccess$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.tT),(0,i.M)(g=>this.message.success("Votre quittance a bien \xe9t\xe9 envoy\xe9e.")),(0,r.T)(g=>(0,s.Y6)()))),this.sendRentReceiptFaillure$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.eV),(0,i.M)(g=>this.message.error("Failed to send rent receipt"))),{dispatch:!1}),this.loadMonthlyRents$=(0,e.EH)(()=>this.actions$.pipe((0,e.gp)(s.Y6),(0,n.n)(()=>this.rentsService.loadMonthlyRents().pipe((0,r.T)(g=>(0,s.Dh)({monthlyRents:g})),(0,h.W)(g=>(0,E.of)((0,s.Eh)(g)))))))}static{this.\u0275fac=function(d){return new(d||v)(u.KVO(e.En),u.KVO(R.M),u.KVO(O.xh))}}static{this.\u0275prov=u.jDH({token:v,factory:v.\u0275fac})}}return v})()},2062:(z,D,t)=>{t.d(D,{g:()=>e,o:()=>n});const e=i=>({name:i.get("name").value,street:i.get("street").value,city:i.get("city").value,zip:i.get("zip").value,signature:i.get("signature")?.value}),n=(i,r)=>({name:i.get("name").value,street:i.get("street").value,city:i.get("city").value,zip:i.get("zip").value,signature:i.get("signature")?.value,id:r})}}]);